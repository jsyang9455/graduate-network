<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì§€ì‚¬í•­ ê´€ë¦¬ - ê´€ë¦¬ì</title>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <style>
        body {
            background: #f8f9fa;
        }

        .admin-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .admin-header {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .admin-header h1 {
            color: #1e3a8a;
            margin: 0 0 0.5rem 0;
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #64748b;
            transition: all 0.3s;
        }

        .tab.active {
            color: #1e3a8a;
            border-bottom-color: #3b82f6;
        }

        .content-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #475569;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: #f8fafc;
            font-weight: 600;
            color: #1e293b;
        }

        tr:hover {
            background: #f8fafc;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .close {
            font-size: 2rem;
            cursor: pointer;
            color: #64748b;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #1e293b;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .array-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .array-input input {
            flex: 1;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag-item {
            background: #eff6ff;
            color: #1e40af;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-remove {
            cursor: pointer;
            color: #ef4444;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="sidebar-menu">
                <a href="dashboard.html" class="menu-item">
                    <span class="icon">ğŸ </span>
                    <span>ëŒ€ì‹œë³´ë“œ</span>
                </a>
                <div style="border-top: 1px solid #e5e7eb; margin: 1rem 0; padding-top: 1rem;">
                    <p style="padding: 0 1rem; color: #6b7280; font-size: 0.875rem; font-weight: 600;">ê´€ë¦¬ì ë©”ë‰´</p>
                </div>
                <a href="admin-users.html" class="menu-item">
                    <span class="icon">ğŸ‘¥</span>
                    <span>íšŒì› ê´€ë¦¬</span>
                </a>
                <a href="admin-jobs.html" class="menu-item">
                    <span class="icon">ğŸ’¼</span>
                    <span>ì±„ìš©ê³µê³  ê´€ë¦¬</span>
                </a>
                <a href="admin-board.html" class="menu-item">
                    <span class="icon">ğŸ“‹</span>
                    <span>ê²Œì‹œíŒ ê´€ë¦¬</span>
                </a>
                <a href="admin-codes.html" class="menu-item">
                    <span class="icon">âš™ï¸</span>
                    <span>ì½”ë“œ ê´€ë¦¬</span>
                </a>
                <a href="admin-announcements.html" class="menu-item active">
                    <span class="icon">ğŸ“¢</span>
                    <span>ê³µì§€ì‚¬í•­ ê´€ë¦¬</span>
                </a>
            </div>
            <div class="sidebar-footer">
                <button onclick="auth.logout()" class="btn-logout">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </aside>

        <main class="main-content">
            <header class="content-header">
                <h1>ğŸ“¢ ê³µì§€ì‚¬í•­ ê´€ë¦¬</h1>
                <div class="user-info">
                    <span id="userName"></span>
                </div>
            </header>

            <div class="admin-content">

        <div class="tabs">
            <button class="tab active" data-type="job-fair" onclick="switchTab('job-fair')">ì·¨ì—… ë°•ëŒíšŒ</button>
            <button class="tab" data-type="industry-visit" onclick="switchTab('industry-visit')">ì‚°ì—…ì²´ ê²¬í•™</button>
            <button class="tab" data-type="certification" onclick="switchTab('certification')">ê¸°ìˆ  ìê²©ì¦</button>
            <button class="tab" data-type="applications" onclick="switchTab('applications')">ğŸ“ ì‹ ì²­ ë‚´ì—­</button>
        </div>

        <!-- ê³µì§€ì‚¬í•­ ëª©ë¡ ì„¹ì…˜ -->
        <div id="announcementSection" class="content-section">
            <div class="section-header">
                <h2 id="sectionTitle">ì·¨ì—… ë°•ëŒíšŒ</h2>
                <button class="btn btn-primary" onclick="openAddModal()">+ ìƒˆ ê³µì§€ì‚¬í•­ ë“±ë¡</button>
            </div>
            <div id="tableContainer"></div>
        </div>

        <!-- ì‹ ì²­ ë‚´ì—­ ì„¹ì…˜ -->
        <div id="applicationsSection" class="content-section" style="display:none;">
            <div class="section-header">
                <h2>ì‹ ì²­ ë‚´ì—­ ì¡°íšŒ</h2>
                <div style="display:flex; gap:1rem; align-items:center;">
                    <select id="appTypeFilter" onchange="loadApplications()" style="padding:0.5rem 1rem; border:1px solid #d1d5db; border-radius:8px;">
                        <option value="">ì „ì²´ ìœ í˜•</option>
                        <option value="job-fair">ì·¨ì—…ë°•ëŒíšŒ</option>
                        <option value="industry-visit">ì‚°ì—…ì²´ê²¬í•™</option>
                        <option value="certification">ê¸°ìˆ ìê²©ì¦</option>
                    </select>
                    <button class="btn btn-secondary" onclick="loadApplications()">ìƒˆë¡œê³ ì¹¨</button>
                </div>
            </div>
            <div id="applicationsTable"></div>
        </div>

            </div>
        </main>
    </div>

    <!-- ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="announcementModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ê³µì§€ì‚¬í•­ ë“±ë¡</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="announcementForm">
                <input type="hidden" id="announcementId">

                <div class="form-group">
                    <label>ì¹´í…Œê³ ë¦¬ *</label>
                    <select id="announcementType" required>
                        <option value="job-fair">ğŸ¢ ì·¨ì—…ë°•ëŒíšŒ</option>
                        <option value="industry-visit">ğŸ­ ì‚°ì—…ì²´ ê²¬í•™</option>
                        <option value="certification">ğŸ“œ ê¸°ìˆ  ìê²©ì¦</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ì œëª© *</label>
                    <input type="text" id="title" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì£¼ìµœê¸°ê´€</label>
                        <input type="text" id="organizer">
                    </div>
                    <div class="form-group">
                        <label>í‰ì </label>
                        <input type="number" id="rating" min="0" max="5" step="0.1">
                    </div>
                </div>

                <div class="form-group">
                    <label>ì„¤ëª…</label>
                    <textarea id="description"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>í–‰ì‚¬ì¼ì</label>
                        <input type="date" id="event_date">
                    </div>
                    <div class="form-group">
                        <label>ì‹œê°„</label>
                        <input type="text" id="event_time" placeholder="ì˜ˆ: 10:00 - 17:00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì¥ì†Œ</label>
                        <input type="text" id="location">
                    </div>
                    <div class="form-group">
                        <label>ì‹ ì²­ë§ˆê°ì¼</label>
                        <input type="date" id="deadline">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì •ì›</label>
                        <input type="number" id="capacity">
                    </div>
                    <div class="form-group">
                        <label>í˜„ì¬ ì‹ ì²­ì¸ì›</label>
                        <input type="number" id="current_applicants" value="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì°¸ê°€ë¹„</label>
                        <input type="text" id="fee" placeholder="ì˜ˆ: ë¬´ë£Œ, 3ë§Œì›">
                    </div>
                    <div class="form-group">
                        <label>ë¦¬ë·° ìˆ˜</label>
                        <input type="number" id="review_count" value="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì—°ë½ì²˜</label>
                        <input type="tel" id="contact_phone">
                    </div>
                    <div class="form-group">
                        <label>ì´ë©”ì¼</label>
                        <input type="email" id="contact_email">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>ì´ë¯¸ì§€ URL</label>
                        <input type="url" id="image_url">
                    </div>
                    <div class="form-group">
                        <label>ìƒì„¸í˜ì´ì§€ URL</label>
                        <input type="url" id="detail_url">
                    </div>
                </div>

                <div class="form-group">
                    <label>í˜œíƒ (ì—”í„°ë¡œ ì¶”ê°€)</label>
                    <div id="benefitsContainer">
                        <div class="array-input">
                            <input type="text" id="benefitInput" placeholder="í˜œíƒ ì…ë ¥ í›„ ì—”í„°">
                        </div>
                        <div class="tag-container" id="benefitsList"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label>ì¤€ë¹„ì‚¬í•­/ìš”êµ¬ì‚¬í•­ (ì—”í„°ë¡œ ì¶”ê°€)</label>
                    <div id="requirementsContainer">
                        <div class="array-input">
                            <input type="text" id="requirementInput" placeholder="ì¤€ë¹„ì‚¬í•­ ì…ë ¥ í›„ ì—”í„°">
                        </div>
                        <div class="tag-container" id="requirementsList"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label>íƒœê·¸ (ì—”í„°ë¡œ ì¶”ê°€)</label>
                    <div id="tagsContainer">
                        <div class="array-input">
                            <input type="text" id="tagInput" placeholder="íƒœê·¸ ì…ë ¥ í›„ ì—”í„°">
                        </div>
                        <div class="tag-container" id="tagsList"></div>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">ì €ì¥</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script>
        let currentType = 'job-fair';
        let announcements = [];
        let editingId = null;

        // ë°°ì—´ ë°ì´í„°
        let benefits = [];
        let requirements = [];
        let tags = [];

        document.addEventListener('DOMContentLoaded', () => {
            checkAdminAuth();
            loadAnnouncements();
            setupArrayInputs();
        });

        function checkAdminAuth() {
            const user = auth.getCurrentUser();
            if (!user || user.user_type !== 'admin') {
                alert('ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                window.location.href = 'login.html';
            }
            const userNameEl = document.getElementById('userName');
            if (userNameEl && user) userNameEl.textContent = user.name;
        }

        async function loadAnnouncements() {
            try {
                const response = await api.get(`/announcements/${currentType}`);
                announcements = response.announcements || [];
                displayAnnouncements();
            } catch (error) {
                console.error('ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨:', error);
                displayAnnouncements();
            }
        }

        function displayAnnouncements() {
            const container = document.getElementById('tableContainer');
            
            if (announcements.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 3rem; color: #64748b;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            container.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>ì œëª©</th>
                            <th>ì£¼ìµœê¸°ê´€</th>
                            <th>í–‰ì‚¬ì¼</th>
                            <th>ì‹ ì²­í˜„í™©</th>
                            <th>ë“±ë¡ì¼</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${announcements.map((item, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${item.title}</td>
                                <td>${item.organizer || '-'}</td>
                                <td>${item.event_date ? new Date(item.event_date).toLocaleDateString('ko-KR') : '-'}</td>
                                <td>${item.current_applicants || 0}/${item.capacity || '-'}</td>
                                <td>${new Date(item.created_at).toLocaleDateString('ko-KR')}</td>
                                <td>
                                    <button class="btn btn-sm btn-secondary" onclick="editAnnouncement(${item.id})">ìˆ˜ì •</button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteAnnouncement(${item.id})">ì‚­ì œ</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function switchTab(type) {
            currentType = type;

            // íƒ­ í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            const activeTab = document.querySelector(`.tab[data-type="${type}"]`);
            if (activeTab) activeTab.classList.add('active');

            if (type === 'applications') {
                document.getElementById('announcementSection').style.display = 'none';
                document.getElementById('applicationsSection').style.display = 'block';
                loadApplications();
            } else {
                document.getElementById('announcementSection').style.display = 'block';
                document.getElementById('applicationsSection').style.display = 'none';

                const titles = { 'job-fair': 'ì·¨ì—… ë°•ëŒíšŒ', 'industry-visit': 'ì‚°ì—…ì²´ ê²¬í•™', 'certification': 'ê¸°ìˆ  ìê²©ì¦' };
                document.getElementById('sectionTitle').textContent = titles[type];
                loadAnnouncements();
            }
        }

        function openAddModal() {
            editingId = null;
            document.getElementById('modalTitle').textContent = 'ê³µì§€ì‚¬í•­ ë“±ë¡';
            document.getElementById('announcementForm').reset();
            document.getElementById('announcementType').value = currentType;
            benefits = [];
            requirements = [];
            tags = [];
            updateArrayDisplay();
            document.getElementById('announcementModal').style.display = 'flex';
        }

        async function editAnnouncement(id) {
            const item = announcements.find(a => a.id === id);
            if (!item) return;

            editingId = id;
            document.getElementById('modalTitle').textContent = 'ê³µì§€ì‚¬í•­ ìˆ˜ì •';
            document.getElementById('announcementId').value = id;
            document.getElementById('announcementType').value = item.type;
            document.getElementById('title').value = item.title || '';
            document.getElementById('organizer').value = item.organizer || '';
            document.getElementById('description').value = item.description || '';
            document.getElementById('event_date').value = item.event_date || '';
            document.getElementById('event_time').value = item.event_time || '';
            document.getElementById('location').value = item.location || '';
            document.getElementById('deadline').value = item.deadline || '';
            document.getElementById('capacity').value = item.capacity || '';
            document.getElementById('current_applicants').value = item.current_applicants || 0;
            document.getElementById('fee').value = item.fee || '';
            document.getElementById('contact_phone').value = item.contact_phone || '';
            document.getElementById('contact_email').value = item.contact_email || '';
            document.getElementById('rating').value = item.rating || '';
            document.getElementById('review_count').value = item.review_count || 0;
            document.getElementById('image_url').value = item.image_url || '';
            document.getElementById('detail_url').value = item.detail_url || '';

            benefits = Array.isArray(item.benefits) ? item.benefits : [];
            requirements = Array.isArray(item.requirements) ? item.requirements : [];
            tags = Array.isArray(item.tags) ? item.tags : [];
            updateArrayDisplay();

            document.getElementById('announcementModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('announcementModal').style.display = 'none';
        }

        function setupArrayInputs() {
            // í˜œíƒ
            document.getElementById('benefitInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const value = e.target.value.trim();
                    if (value) {
                        benefits.push(value);
                        e.target.value = '';
                        updateArrayDisplay();
                    }
                }
            });

            // ì¤€ë¹„ì‚¬í•­
            document.getElementById('requirementInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const value = e.target.value.trim();
                    if (value) {
                        requirements.push(value);
                        e.target.value = '';
                        updateArrayDisplay();
                    }
                }
            });

            // íƒœê·¸
            document.getElementById('tagInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const value = e.target.value.trim();
                    if (value) {
                        tags.push(value);
                        e.target.value = '';
                        updateArrayDisplay();
                    }
                }
            });
        }

        function updateArrayDisplay() {
            document.getElementById('benefitsList').innerHTML = benefits.map((item, i) => 
                `<span class="tag-item">${item} <span class="tag-remove" onclick="removeBenefit(${i})">Ã—</span></span>`
            ).join('');

            document.getElementById('requirementsList').innerHTML = requirements.map((item, i) => 
                `<span class="tag-item">${item} <span class="tag-remove" onclick="removeRequirement(${i})">Ã—</span></span>`
            ).join('');

            document.getElementById('tagsList').innerHTML = tags.map((item, i) => 
                `<span class="tag-item">${item} <span class="tag-remove" onclick="removeTag(${i})">Ã—</span></span>`
            ).join('');
        }

        function removeBenefit(index) {
            benefits.splice(index, 1);
            updateArrayDisplay();
        }

        function removeRequirement(index) {
            requirements.splice(index, 1);
            updateArrayDisplay();
        }

        function removeTag(index) {
            tags.splice(index, 1);
            updateArrayDisplay();
        }

        document.getElementById('announcementForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                type: document.getElementById('announcementType').value,
                title: document.getElementById('title').value,
                organizer: document.getElementById('organizer').value,
                description: document.getElementById('description').value,
                event_date: document.getElementById('event_date').value || null,
                event_time: document.getElementById('event_time').value,
                location: document.getElementById('location').value,
                deadline: document.getElementById('deadline').value || null,
                capacity: parseInt(document.getElementById('capacity').value) || null,
                current_applicants: parseInt(document.getElementById('current_applicants').value) || 0,
                fee: document.getElementById('fee').value,
                contact_phone: document.getElementById('contact_phone').value,
                contact_email: document.getElementById('contact_email').value,
                rating: parseFloat(document.getElementById('rating').value) || null,
                review_count: parseInt(document.getElementById('review_count').value) || 0,
                image_url: document.getElementById('image_url').value,
                detail_url: document.getElementById('detail_url').value,
                benefits: benefits,
                requirements: requirements,
                tags: tags
            };

            try {
                const savedType = data.type;
                if (editingId) {
                    await api.put(`/announcements/${editingId}`, data);
                    alert('ê³µì§€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    await api.post('/announcements', data);
                    alert('ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
                closeModal();
                switchTab(savedType);
            } catch (error) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n' + (error.message || ''));
            }
        });

        async function deleteAnnouncement(id) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            try {
                await api.delete(`/announcements/${id}`);
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadAnnouncements();
            } catch (error) {
                console.error('ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì‹ ì²­ ë‚´ì—­ ë¡œë“œ
        async function loadApplications() {
            const type = document.getElementById('appTypeFilter')?.value || '';
            try {
                const response = await api.get(`/announcements/applications/all${type ? '?type=' + type : ''}`);
                displayApplications(response.applications || []);
            } catch (error) {
                console.error('ì‹ ì²­ ë‚´ì—­ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('applicationsTable').innerHTML = '<p style="color:#ef4444; padding:2rem;">ì‹ ì²­ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        function displayApplications(apps) {
            const container = document.getElementById('applicationsTable');
            if (apps.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:3rem; color:#64748b;"><p style="font-size:3rem;">ğŸ“‹</p><p>ì‹ ì²­ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            const typeName = { 'job-fair': 'ì·¨ì—…ë°•ëŒíšŒ', 'industry-visit': 'ì‚°ì—…ì²´ê²¬í•™', 'certification': 'ê¸°ìˆ ìê²©ì¦' };
            const statusLabel = { 'pending': 'â³ ì ‘ìˆ˜ì¤‘', 'approved': 'âœ… ìŠ¹ì¸', 'rejected': 'âŒ ë°˜ë ¤' };
            const statusColor = { 'pending': '#f59e0b', 'approved': '#10b981', 'rejected': '#ef4444' };

            container.innerHTML = `
                <p style="color:#64748b; margin-bottom:1rem; font-size:0.9rem;">ì „ì²´ ${apps.length}ê±´</p>
                <table style="width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; box-shadow:0 1px 4px rgba(0,0,0,0.1);">
                    <thead>
                        <tr style="background:#1e3a8a; color:white;">
                            <th style="padding:1rem; text-align:left;">#</th>
                            <th style="padding:1rem; text-align:left;">ì±„ë„</th>
                            <th style="padding:1rem; text-align:left;">ê³µê³ ëª…</th>
                            <th style="padding:1rem; text-align:left;">ì‹ ì²­ì</th>
                            <th style="padding:1rem; text-align:left;">ì—°ë½ì²˜</th>
                            <th style="padding:1rem; text-align:left;">ì´ë©”ì¼</th>
                            <th style="padding:1rem; text-align:left;">ì‹ ì²­ì¼</th>
                            <th style="padding:1rem; text-align:left;">ìƒíƒœ</th>
                            <th style="padding:1rem; text-align:left;">ì²˜ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${apps.map((app, idx) => `
                        <tr style="border-bottom:1px solid #f1f5f9; ${idx % 2 === 0 ? '' : 'background:#fafafa;'}">
                            <td style="padding:0.875rem 1rem; color:#64748b;">${idx + 1}</td>
                            <td style="padding:0.875rem 1rem;"><span style="background:#e0e7ff; color:#3730a3; padding:0.2rem 0.6rem; border-radius:20px; font-size:0.8rem;">${typeName[app.announcement_type] || app.announcement_type}</span></td>
                            <td style="padding:0.875rem 1rem; font-weight:500; max-width:200px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;" title="${app.announcement_title}">${app.announcement_title}</td>
                            <td style="padding:0.875rem 1rem; font-weight:600;">${app.applicant_name}</td>
                            <td style="padding:0.875rem 1rem;">${app.applicant_phone}</td>
                            <td style="padding:0.875rem 1rem; color:#64748b; font-size:0.9rem;">${app.applicant_email || '-'}</td>
                            <td style="padding:0.875rem 1rem; color:#64748b; font-size:0.9rem;">${new Date(app.created_at).toLocaleDateString('ko-KR')}</td>
                            <td style="padding:0.875rem 1rem;"><span style="color:${statusColor[app.status]}; font-weight:600;">${statusLabel[app.status] || app.status}</span></td>
                            <td style="padding:0.875rem 1rem;">
                                <select onchange="updateAppStatus(${app.id}, this.value)" style="padding:0.3rem 0.5rem; border:1px solid #d1d5db; border-radius:6px; font-size:0.85rem; cursor:pointer;">
                                    <option value="pending" ${app.status === 'pending' ? 'selected' : ''}>ì ‘ìˆ˜ì¤‘</option>
                                    <option value="approved" ${app.status === 'approved' ? 'selected' : ''}>ìŠ¹ì¸</option>
                                    <option value="rejected" ${app.status === 'rejected' ? 'selected' : ''}>ë°˜ë ¤</option>
                                </select>
                            </td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        async function updateAppStatus(id, status) {
            try {
                await api.put(`/announcements/applications/${id}/status`, { status });
                loadApplications();
            } catch (error) {
                alert('ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                loadApplications();
            }
        }
    </script>
</body>
</html>
